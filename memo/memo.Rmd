---
title: "Project memo"
author: "Team name"
output: github_document
---

This document should contain a detailed account of the data clean up for your data and the design choices you are making for your plots. For instance you will want to document choices you've made that were intentional for your graphic, e.g. color you've chosen for the plot. Think of this document as a code script someone can follow to reproduce the data cleaning steps and graphics in your handout.

```{r load-packages, message = FALSE}
library(tidyverse)
library(broom)

```

## Data Clean Up Steps for Overall Data

### Step 1: Load and clean all data

<<<<<<< HEAD

### Step 2: ________

## Plots

### ggsave example for saving plots

```{r starwars ggsave example}
p1 <- starwars |>
  filter(mass < 1000, 
         species %in% c("Human", "Cerean", "Pau'an", "Droid", "Gungan")) |>
  ggplot() +
  geom_point(aes(x = mass, 
                 y = height, 
                 color = species)) +
  labs(x = "Weight (kg)", 
       y = "Height (m)",
       color = "Species",
       title = "Weight and Height of Select Starwars Species",
       caption = paste("This data comes from the starwars api: https://swapi.py43.com"))


ggsave("example-starwars.png", width = 4, height = 4)

ggsave("example-starwars-wide.png", width = 6, height = 4)
```

```{r}
kids_overweight <- read_csv("/cloud/project/data/kids_overweight.csv")
```

```{r}
kids_overweight <- kids_overweight |>
  mutate(Age = fct_relevel(Age, "14 or younger", "15", "16", "17"))

# Plot histogram
ggplot(kids_overweight, aes(x = Age, weight = Percentage)) +
  geom_histogram(stat = "count", fill = "orange", color = "black") +
  labs(title = "Overweight Kids by Age",
       x = "Age",
       y = "Percentage of Overweight Kids") +
  theme_minimal()
```

```{r}
family_support_data <- read.csv ("/cloud/project/data/love_support_family.csv")
```


```{r}
view(family_support_data)
```




```{r}
data <- data.frame(
  Age = c("14 or younger", "15", "16", "17", "18 or older"),
  Overweight = c(18.4, 21.2, 19.0, 17.6, 14.3),
  FamilySupport = c(79.80, 77.20, 81.80, 79.70, 76)  # Replace with actual values if available
)

data_long <- data %>%
  pivot_longer(cols = c(Overweight, FamilySupport), 
               names_to = "Category", values_to = "Percentage")

ggplot(data_long, aes(x = Age, y = Percentage, fill = Category)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.7), width = 0.6) +
  scale_fill_manual(values = c("Overweight" = "#66c2a5", "FamilySupport" = "#fc8d62")) +
  labs(
    title = "Comparison of Overweight Kids and Family Support by Age",
    x = "Age Group",
    y = "Percentage",
    fill = "Category"
  ) +
  theme_minimal(base_size = 14) +
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5))
```


### Plot 1: Grade vs. Drinking data

#### Data cleanup steps specific to plot 1

These data cleaning sections are optional and depend on if you have some data cleaning steps specific to plot 1

```{r data-cleanup-plot-1}

kids_overweight <- read_csv("/cloud/project/data/kids_overweight.csv")

family_support_data <- read.csv ("/cloud/project/data/love_support_family.csv")

drinking_vs_family <- read.csv ("/cloud/project/data/drinking_fam_GRADE.csv")

Drinking_vs_family <- drinking_vs_family |>
  mutate(
    Grade = fct_recode(Grade, 
                       NULL = "")
  )

Drinking_data_cleaner <- read.csv("../data/drunk_high_data_2.csv")


```

### Step 2: Plot Specific Cleanup/Code for Visualizations

## Plots

### Plot 1: Grade vs. Drinking data

#### Final Plot 1

```{r plot-1-visualization}
Drinking_vs_family |>
mutate('Grade' = fct_relevel(Grade,
                               "Grade 9", 
                               "Grade 10", 
                               "Grade 11", 
                               "Grade 12"), 
         GradePercent = as.numeric(gsub("%", "", GradePercent))) |>
  filter(!is.na(Grade) & !is.na(`GradePercent`)) |>
  ggplot(aes(x = Grade, y = `GradePercent`, fill = Grade)) +
  geom_col(na.rm = TRUE) +
  scale_y_continuous(breaks = seq(0, 20, by = 5),
                     labels = scales::label_percent(scale = 1)) + 
  labs(x = NULL, 
       y = 'Percentage', 
       title = 'How many times in the past year have you been drunk/high at school?', 
       subtitle = "Grade vs. Percentage of Students Who Answered 'At Least One Time'")+
  theme_classic()

ggsave("../plots/plot-1.jpg", width = 10, height = 4)
```


### Plot 2: Family support at home vs. Drinking Data

#### Plot 2 Cleanup

```{r}

family_support_data <- read.csv ("/cloud/project/data/love_support_family.csv")
drinking_vs_family <- read.csv ("/cloud/project/data/drinking_fam_GRADE.csv")

Drinking_vs_family <- drinking_vs_family |>
  mutate(
    Grade = fct_recode(Grade, 
                       NULL = "")
  )
```


#### Final Plot 2

```{r plot-2-visualization}
Drinking_vs_family |>
  mutate('Grade' = fct_relevel(Grade,
                               "Grade 9", 
                               "Grade 10", 
                               "Grade 11", 
                               "Grade 12"), 
         GradePercent = as.numeric(gsub("%", "", GradePercent)),
         FamGradePer. = as.numeric(gsub("%", "", FamGradePer.))) |>
  filter(!is.na(Grade) & !is.na(`GradePercent`)) |>
  pivot_longer(
    cols = c(GradePercent, FamGradePer.),
    names_to = "Metric",
    values_to = "Percent") |>
  mutate(Metric = recode(Metric,
                       GradePercent = "Been Drunk/High at School",
                       `FamGradePer.` = "Felt Supported by Family")) |>
  ggplot(aes(x = Grade, y = `Percent`, fill = Metric)) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_y_continuous(breaks = seq(0, 100, by = 10),
                     labels = scales::label_percent(scale = 1)) +
  labs(x = NULL, 
       y = 'Percentage', 
       title = 'Family support vs. being drunk or high at school by grade') +
  theme_classic()
  
ggsave("../plots/plot-2.jpg", width = 10, height = 4)
```

### Plot 3: Percentage of overweight kids categorized by age

```{r}
kids_overweight <- kids_overweight |>
  mutate(Age = fct_relevel(Age, "14 or younger", "15", "16", "17"))

ggplot(kids_overweight, aes(x = Age, weight = Percentage)) +
  geom_histogram(stat = "count", fill = "skyblue", color = "black") +
  labs(title = "Overweight Kids by Age",
       x = "Age",
       y = "Percentage of Overweight Kids") +
  theme_minimal()
```

### Plot 4: Percentage of Kids Overweight by Age 

```{r}
data <- data.frame(
  Age = c("14 or younger", "15", "16", "17", "18 or older"),
  Overweight = c(18.4, 21.2, 19.0, 17.6, 14.3),
  FamilySupport = c(79.80, 77.20, 81.80, 79.70, 76)
)

# Convert to long format
data_long <- data %>%
  pivot_longer(cols = c(Overweight, FamilySupport), 
               names_to = "Category", values_to = "Percentage")

# Plot
ggplot(data_long, aes(x = , y = Percentage, fill = Category)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.7), width = 0.6) +
  scale_fill_manual(values = c("Overweight" = "#66c2a5", "FamilySupport" = "#fc8d62")) +
  labs(
    title = "Comparison of Overweight Kids and Family Support by Age",
    x = "Age Group",
    y = "Percentage",
    fill = "Category"
  ) +
  theme_minimal(base_size = 14) +
  theme(axis.text.x = element_text(angle = 0, vjust = 0.5))
```

```{r}
#install.packages("janitor")
library(readxl)
library(tidyverse)
library(janitor)

# Clean column names first
final_data_clean <- final_data %>%
  clean_names()

# Now select and reshape the cleaned data
plot_df <- final_data_clean %>%
  select(age = age_x,
         male_drunk_high = male_drunk_high_in_school_1_time,
         female_drunk_high = female_drunk_high_in_school_1_time,
         male_meals = males_7_meals_a_week,
         female_meals = female_7_meals_a_week) %>%
  drop_na() %>%
  pivot_longer(cols = -age, names_to = "category", values_to = "count") %>%
  mutate(
    type = if_else(str_detect(category, "drunk_high"), "Drunk High", "7 Meals"),
    gender = if_else(str_detect(category, "male"), "Male", "Female")
  )

# Plot the result
ggplot(plot_df, aes(x = age, y = count, fill = interaction(type, gender))) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Comparison of 'Drunk High in School (1 time)' and '7 Meals a Week' by Gender",
       x = "Age Group",
       y = "Number of Students",
       fill = "Type and Gender") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

```{r Students Drunk or High In School VS 7 Family Meals per week By Gender}
library(tidyverse)

plot_df <- drunk_smoke_meals_data %>%
  select(
    Age = `Age.x`,
    Male_Drunk_High = `Male Drunk High in school 1 time`,
    Female_Drunk_High = `Female Drunk High in school 1 time`,
    Male_Meals = `Males 7 meals a week`,
    Female_Meals = `Female 7 meals a week`
  ) %>%
  drop_na() %>%
  mutate(Age = factor(Age, levels = c("<=14", "15.0", "16.0", "17.0", ">=18"))) %>%
  pivot_longer(
    cols = -Age,
    names_to = "Category",
    values_to = "Count"
  )

ggplot(plot_df, aes(x = Age, y = Count, fill = Category)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(
    title = "Students Drunk or High In School VS 7 Family Meals Per Week By Gender",
    x = "Age",
    y = "Number of Students",
    fill = "Category"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```



```{r}
colnames(drunk_smoke_meals_data)
```



```{r family-meals-thing}
library(tidyverse)

bar_df <- drunk_smoke_meals_data %>%
  select(
    Age = `Age.x`,
    Male_Smoking = `Males 7 days in room atleat 1 cig`,
    Female_Smoking = `Female 7 days in room atleat 1 cig`,
    Male_Meals = `Males 7 meals a week`,
    Female_Meals = `Female 7 meals a week`
  ) %>%
  drop_na() %>%
  pivot_longer(cols = -Age, names_to = "Category", values_to = "Count") %>%
  mutate(
    Gender = case_when(
      str_detect(Category, "Male") ~ "Male",
      str_detect(Category, "Female") ~ "Female"
    ),
    Type = case_when(
      str_detect(Category, "Smoking") ~ "Smoking",
      str_detect(Category, "Meals") ~ "7 Meals"
    ),
    Age = factor(Age, levels = c("<=14", "15.0", "16.0", "17.0", ">=18"))
  )

ggplot(bar_df, aes(x = Age, y = Count, fill = Type)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~ Gender) +
  labs(
    title = "Being Around Smoking VS 7 Family Meals Per Week By Age And Gender",
    x = "Age Group",
    y = "Number of Students",
    fill = "Behavior"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


```

